# Cerberus Configuration
# Multi-agent AI code review system
version: 1

name: "Cerberus"
required_check: "Cerberus / Verdict"
mode: parallel                      # parallel | sequential
cancel_in_progress: true            # Cancel stale runs on new push

model:
  default: "openrouter/moonshotai/kimi-k2.5"
  fallback:
    - "openrouter/google/gemini-3-flash-preview"
    - "openrouter/z-ai/glm-5"
  pool:
    - "openrouter/moonshotai/kimi-k2.5"
    - "openrouter/minimax/minimax-m2.5"
    - "openrouter/google/gemini-3.1-pro-preview"
    - "openrouter/google/gemini-3-flash-preview"
    - "openrouter/deepseek/deepseek-v3.2"
    - "openrouter/z-ai/glm-5"
  cli: opencode
  thinking: true
  max_steps: 25                       # Max agentic steps per reviewer
  timeout: 600                        # Seconds per reviewer

routing:
  enabled: true
  model: "openrouter/google/gemini-3-flash-preview"
  panel_size: 5
  always_include:
    - trace      # correctness always runs
  include_if_code_changed:
    - guard      # security runs if non-test/non-doc code changed
  fallback_panel:
    - trace
    - atlas
    - guard
    - craft
    - proof

override:
  enabled: true
  command: "/cerberus override"
  actor: pr_author                    # pr_author | write_access | maintainers_only
  require_reason: true
  pin_to_sha: true

# Verdict rules
verdict:
  fail_on: "any_critical_or_2_major"  # any_critical | any_critical_or_2_major | any_major
  warn_on: "any_major_or_5_minor_or_3_minor_same_category"  # any_major | any_major_or_5_minor_or_3_minor_same_category
  confidence_min: 0.7

council_verdict:
  fail_on: "any_critical_fail_or_2_fails"  # single non-critical FAIL is downgraded to WARN

# The twelve reviewers of Cerberus.
# Names are codenames — perspective determines behavior.
reviewers:
  # --- Existing (renamed) ---
  - name: trace
    perspective: correctness
    model: "openrouter/moonshotai/kimi-k2.5"
    description: "Correctness — Find the bug"
    override: pr_author
    tools:
      shell: false

  - name: atlas
    perspective: architecture
    model: "openrouter/z-ai/glm-5"
    description: "Architecture — Zoom out"
    override: pr_author
    tools:
      shell: false

  - name: guard
    perspective: security
    model: "openrouter/minimax/minimax-m2.5"
    description: "Security — Think like an attacker"
    override: maintainers_only
    tools:
      shell: false

  - name: flux
    perspective: performance
    model: "openrouter/google/gemini-3-flash-preview"
    description: "Performance — Think at runtime"
    override: pr_author
    tools:
      shell: false

  - name: craft
    perspective: maintainability
    model: "openrouter/moonshotai/kimi-k2.5"
    description: "Maintainability — Think like the next dev"
    override: pr_author
    tools:
      shell: false

  - name: proof
    perspective: testing
    model: "openrouter/google/gemini-3-flash-preview"
    description: "Testing — See what will break"
    override: pr_author
    tools:
      shell: false

  # --- New ---
  - name: scribe
    perspective: documentation
    model: pool
    description: "Documentation — Keep the map accurate"
    override: pr_author
    tools:
      shell: false

  - name: fuse
    perspective: resilience
    model: pool
    description: "Resilience — What happens when the happy path fails"
    override: pr_author
    tools:
      shell: false

  - name: pact
    perspective: compatibility
    model: pool
    description: "Compatibility — Trace the client impact"
    override: pr_author
    tools:
      shell: false

  - name: chain
    perspective: dependencies
    model: pool
    description: "Dependencies — Guard the supply chain"
    override: pr_author
    tools:
      shell: false

  - name: anchor
    perspective: data-integrity
    model: pool
    description: "Data Integrity — Protect the schema"
    override: pr_author
    tools:
      shell: false

  - name: signal
    perspective: observability
    model: pool
    description: "Observability — Make bugs scream loudly"
    override: pr_author
    tools:
      shell: false
